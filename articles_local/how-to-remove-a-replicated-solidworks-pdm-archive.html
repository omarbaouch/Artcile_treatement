<p>When retiring a replicated archive server within <a href="https://www.javelin-tech.com/3d/technology/solidworks-pdm-professional/">SOLIDWORKS PDM Professional</a> it’s important to use the recommended steps to ensure all replication information in the database for the server will be removed, along with any archives.</p>
<blockquote><p><strong>CRITICAL</strong>: This operation is destructive.  It is imperative that <a href="https://www.javelin-tech.com/blog/2019/12/solidworks-pdm-vault-structure-backup/">good vault backups</a> are captured ahead of completing any of the steps within this article.</p></blockquote>
<h2>How to remove a replicated archive server</h2>
<ul>
<li>Open the Administration Tool
<ul>
<li>Locate the server to remove from replication
<ul>
<li>RMB &gt; Remove</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2021/01/Remove-Replicated-Archive-RMB-Remove.png"><img alt="Remove Replicated Archive - RMB Remove" height="493" src="/assets/images/Remove-Replicated-Archive-RMB-Remove.png" title="" width="387"/><noscript><img alt="Remove Replicated Archive - RMB Remove" height="493" src="/assets/images/Remove-Replicated-Archive-RMB-Remove.png" title="" width="387"/></noscript></a></p>
<blockquote><p><strong>NOTE:</strong> In this scenario, the server being retired is <em><strong>WIN-8P6OOFC3A8K</strong></em> and the replicated vault is named <em><strong>JavVault</strong></em></p></blockquote>
<ul>
<li>Confirm the vault is being removed from the appropriate server then enter the SQL credentials and accept that this operation is destructive and confirm that good backups have been captured and hit <strong>Yes</strong></li>
</ul>
<p><div class="wp-caption aligncenter" id="attachment_50630" style="width: 458px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2021/01/Remove-Replicated-Archive-Confirm-SQL-Credentials.png"><img alt="Remove Replicated Archive - SQL Credentials" aria-describedby="caption-attachment-50630" height="253" src="/assets/images/Remove-Replicated-Archive-Confirm-SQL-Credentials.png" title="" width="448"/><p class="wp-caption-text" id="caption-attachment-50630"><noscript><img alt="Remove Replicated Archive - SQL Credentials" height="253" src="/assets/images/Remove-Replicated-Archive-Confirm-SQL-Credentials.png" title="" width="448"/></noscript></p></a> Remove Replicated Archive – SQL Credentials</div></p>
<blockquote><p><strong>ENSURE</strong>: you are removing the replicated vault and not the ‘primary’ vault, we can confirm this if the dialog lists <strong><em>‘…this vault is part of replicated network of vaults, only the local copy of these files will be deleted’</em></strong> as above.</p></blockquote>
<ul>
<li>Click <strong>Yes</strong> to confirm the removal and affected database connections</li>
</ul>
<p><div class="wp-caption aligncenter" id="attachment_50631" style="width: 456px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2021/01/Remove-Replicated-Archive-Confirm-DB-Connections.png"><img alt="Remove Replicated Archive - Confirm DB Connections" aria-describedby="caption-attachment-50631" height="307" src="/assets/images/Remove-Replicated-Archive-Confirm-DB-Connections.png" title="" width="446"/><p class="wp-caption-text" id="caption-attachment-50631"><noscript><img alt="Remove Replicated Archive - Confirm DB Connections" height="307" src="/assets/images/Remove-Replicated-Archive-Confirm-DB-Connections.png" title="" width="446"/></noscript></p></a> Remove Replicated Archive – Confirm DB Connections</div></p>
<p>then…</p>
<p><div class="wp-caption aligncenter" id="attachment_50686" style="width: 404px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2021/01/Remove-Replicated-Archive-Removing.png"><img alt="Remove Replicated Archive - Removing" aria-describedby="caption-attachment-50686" height="130" src="/assets/images/Remove-Replicated-Archive-Removing.png" title="" width="394"/><p class="wp-caption-text" id="caption-attachment-50686"><noscript><img alt="Remove Replicated Archive - Removing" height="130" src="/assets/images/Remove-Replicated-Archive-Removing.png" title="" width="394"/></noscript></p></a> Remove Replicated Archive – Removing</div></p>
<p>and the result;</p>
<p><div class="wp-caption aligncenter" id="attachment_50688" style="width: 516px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2021/01/Remove-Replicated-Archive-Removed.png"><img alt="Remove Replicated Archive - Removed" aria-describedby="caption-attachment-50688" height="514" src="/assets/images/Remove-Replicated-Archive-Removed.png" title="" width="506"/><p class="wp-caption-text" id="caption-attachment-50688"><noscript><img alt="Remove Replicated Archive - Removed" height="514" src="/assets/images/Remove-Replicated-Archive-Removed.png" title="" width="506"/></noscript></p></a> Remove Replicated Archive – Removed</div></p>
<p>If any client’s local views are still attached to this server, they will need to be repointed to an existing archive.  This can be completed by <a href="https://www.javelin-tech.com/blog/2011/06/epdm-deleting-vault-view/">removing and re-adding the local view</a>.</p>
<h3>Why is it important to remove it ahead of retiring the server?</h3>
<p>In a replicated environment, there are values within the ‘ArchiveServerNeighbour’, ‘ArchiveServers’ and ‘ArchiveServerStored’ tables in SQL for the corresponding replicated archive.  Removing the vault using this method will ensure there are no orphaned files, and the archive servers are removed and no longer listed within the replication schema and settings.  If there are any files that have not been replicated ahead of removing the replicated archive the following error will be thrown;</p>
<p><div class="wp-caption aligncenter" id="attachment_50695" style="width: 418px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2021/01/Remove-Replicated-Archive-Files-not-replicated.png"><img alt="SOLIDWORKS PDM Warning" aria-describedby="caption-attachment-50695" height="152" src="/assets/images/Remove-Replicated-Archive-Files-not-replicated.png" title="" width="408"/><p class="wp-caption-text" id="caption-attachment-50695"><noscript><img alt="SOLIDWORKS PDM Warning" height="152" src="/assets/images/Remove-Replicated-Archive-Files-not-replicated.png" title="" width="408"/></noscript></p></a> SOLIDWORKS PDM Warning</div></p>
<p>These files will need to be replicated before the vault can be removed.</p>
