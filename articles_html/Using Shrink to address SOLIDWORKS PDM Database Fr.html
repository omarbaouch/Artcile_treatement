<p>The recommended free disk space for an SQL Server (SOLIDWORKS PDM Professional database), is 15%. If free disk space reaches levels below that, problems can occur. Lower levels can lead to PDM can becoming unusable.</p>
<p>There may not may any notification of low disk space, until running the <a href="https://www.javelin-tech.com/blog/2013/04/solidworks-pdm-database-upgrade-tool">SOLIDWORKS PDM Database Upgrade Wizard</a>.</p>
<p><div id="attachment_46055" style="width: 713px" class="wp-caption aligncenter"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2020/04/PDM-Database-Upgrade-Wizard.png"><img decoding="async" aria-describedby="caption-attachment-46055" class="wp-image-46055 size-full lazyload" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.javelin-tech.com/blog/wp-content/uploads/2020/04/PDM-Database-Upgrade-Wizard.png" alt="SOLIDWORKS PDM Database Upgrade Wizard" width="703" height="452" title=""><p id="caption-attachment-46055" class="wp-caption-text"><noscript><img decoding="async" class="wp-image-46055 size-full lazyload" src="https://www.javelin-tech.com/blog/wp-content/uploads/2020/04/PDM-Database-Upgrade-Wizard.png" alt="SOLIDWORKS PDM Database Upgrade Wizard" width="703" height="452" title="" srcset="https://www.javelin-tech.com/blog/wp-content/uploads/2020/04/PDM-Database-Upgrade-Wizard.png 703w, https://www.javelin-tech.com/blog/wp-content/uploads/2020/04/PDM-Database-Upgrade-Wizard-600x386.png 600w" sizes="(max-width: 703px) 100vw, 703px" /></noscript></a> SOLIDWORKS PDM Database Upgrade Wizard</p></div></p>
<p>The PDM Database Upgrade Wizard, is used to upgrade the SQL database(s), used by PDM. This is normally done after upgrading SOLIDWORKS PDM to a newer release.</p>
<h2>SOLIDWORKS PDM Database Full Errors</h2>
<p>In the case of insufficient disk space, the log created by the PDM Database Upgrade Wizard, will show that there was a failure, but may not provide the cause.  To find the cause we need to look in the PDM USER log. In the log there will be errors such as:</p>
<ul>
<li>SOLIDWORKS® PDM database upgrade (upgrade.exe) to fail with a client log error &#8220;[SQL Server] The transaction log for database &#8216;db_name&#8217; is full&#8221;?</li>
<li>[Microsoft][ODBC SQL Server Driver][SQL Server] The transaction log for database &#8216;db_name&#8217; is full.</li>
</ul>
<p>These errors point to the Transaction Log being full. The Transaction Log records all SQL transactions as well database modifications. The Transaction Log is critical to disaster recovery and should never be deleted or moved.</p>
<p>These messages may occur because the defined maximum Transaction Log size has been reached or because there is no more disk space for the Transaction Log to grow.</p>
<p>The reason that low disk space may not be noted until the use of the PDM Database Upgrade Wizard, is because the Upgrade process will create many temporary tables. The greater the gap between versions of the database(s), the more free space that will be required, during the Upgrade</p>
<p>If disk space becomes more critical, users may start to get the message &#8216;‘Error accessing the database’ and ‘Transaction log is full’ in client log.&#8221;  When investigating this message it is important to determine if Autogrowth has been enabled and that the defined Maximum File Size has not been reached.</p>
<p><div id="attachment_46057" style="width: 1134px" class="wp-caption aligncenter"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2020/04/Transition-Log.png"><img decoding="async" aria-describedby="caption-attachment-46057" class="wp-image-46057 size-full lazyload" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.javelin-tech.com/blog/wp-content/uploads/2020/04/Transition-Log.png" alt="Transition Log - Enable Autogrowth" width="1124" height="632" title=""><p id="caption-attachment-46057" class="wp-caption-text"><noscript><img decoding="async" class="wp-image-46057 size-full lazyload" src="https://www.javelin-tech.com/blog/wp-content/uploads/2020/04/Transition-Log.png" alt="Transition Log - Enable Autogrowth" width="1124" height="632" title="" srcset="https://www.javelin-tech.com/blog/wp-content/uploads/2020/04/Transition-Log.png 1124w, https://www.javelin-tech.com/blog/wp-content/uploads/2020/04/Transition-Log-600x337.png 600w, https://www.javelin-tech.com/blog/wp-content/uploads/2020/04/Transition-Log-768x432.png 768w" sizes="(max-width: 1124px) 100vw, 1124px" /></noscript></a> Transition Log &#8211; Enable Autogrowth</p></div></p>
<p>If the Transaction Log settings are correct the the available disk space should be checked.</p>
<blockquote><p><strong>Only those who are familiar with SQL should make any changes as incorrect settings may have a detrimental effect on PDM use.</strong></p></blockquote>
<h3>How to limit the consumption of disk space</h3>
<p>There are a number of reasons why disk space can become an issue and there are things that can be done to limit the consumption of disk space. Some of these are:</p>
<ul>
<li>Having a dedicated SQL Server. This would mean having a separate server for the PDM Archives. Having separate servers for the PDM Archive and Database, can increase PDM performance, on larger implementations</li>
<li>Using <a href="https://www.javelin-tech.com/blog/2020/02/how-to-change-the-default-recovery-model-option-for-new-sql-databases/">Simple as the Recovery Model for SQL</a>.</li>
<li>Moving old SQL back-ups to a separate server.</li>
</ul>
<p>When disk free space has become critical, there are a couple of solutions. First, would be increase the amount of disk space. The other is to <a href="https://www.javelin-tech.com/blog/2020/03/how-to-shrink-solidworks-pdm-sql-transaction-log/">Shrink</a> the Transition log. The Shrink operation will cause SQL Index fragmentation and this can lead to poor SQL/PDM performance. So it is not recommended that it be used on a regular basis, but in situations where disk space is critical, it may provide stop gap solution, until a final solution can be implemented. Also, on large databases or in environments where there hundreds of users, shrinking databases yearly, may actually increase performance.</p>
