<p>SOLIDWORKS PDM Reorganize Index or Rebuild can increase performance on a <a href="https://www.javelin-tech.com/blog/2015/08/checking-for-index-fragmentation/">fragmented database</a>. If fragmentation is between 10 – 30% then Reorganize is recommended, when above 30% a Rebuild would be best. <strong>For fragmentation values lower than 10%, or for smaller databases, Reorganize and Rebuild may not increase performance</strong>. The SOLIDWORKS Knowledge Base article S-061702 offers a query to find average fragmentation and provides guidance on whether to use the Reorganize or Rebuild tasks.</p>
<h3>How to Reorganize a Single Database</h3>
<p>In the example below, we will look at how to create a one-time task to <strong>Reorganize</strong> a single database. I am specifying a one-time task as I wish to only use this task when fragmentation is between 10 – 30% as noted earlier.</p>
<p>In Microsoft SQL Server Management Studio (2014), under <strong>Management</strong>, right-click on <strong>Management Plans</strong> and select <strong>Maintenance Plan Wizard.</strong></p>
<div class="wp-caption aligncenter" id="attachment_15780" style="width: 432px"><img alt="Start Maintenance Plan Wizard" aria-describedby="caption-attachment-15780" height="499" src="/assets/images/start-task.png" title="" width="422"/><p class="wp-caption-text" id="caption-attachment-15780"><noscript><img alt="Start Maintenance Plan Wizard" height="499" sizes="(max-width: 422px) 100vw, 422px" src="/assets/images/start-task.png" title="" width="422"/></noscript> Start Maintenance Plan Wizard</p></div>
<p>Identify the <strong>Plan Properties</strong>. Since I only want to run this task when there is a minimum amount of fragmentation, I will run this task on-demand, by selecting the<strong> Not Scheduled</strong> option</p>
<div class="wp-caption aligncenter" id="attachment_15776" style="width: 511px"><img alt="Maintenance Plan Properties" aria-describedby="caption-attachment-15776" height="452" src="/assets/images/plan-properties.png" title="" width="501"/><p class="wp-caption-text" id="caption-attachment-15776"><noscript><img alt="Maintenance Plan Properties" height="452" sizes="(max-width: 501px) 100vw, 501px" src="/assets/images/plan-properties.png" title="" width="501"/></noscript> Maintenance Plan Properties</p></div>
<p> </p>
<p>Select the Maintenance Task(s) that will be executed by this Plan.</p>
<div class="wp-caption aligncenter" id="attachment_38986" style="width: 511px"><img alt="" aria-describedby="caption-attachment-38986" height="453" src="/assets/images/Maitenance-Plans-1.png" title="" width="501"/><p class="wp-caption-text" id="caption-attachment-38986"><noscript><img alt="" height="453" src="/assets/images/Maitenance-Plans-1.png" title="" width="501"/></noscript> Maintenance Plan Tasks</p></div>
<p>Along with the Reorganize Task, I have also selected the <a href="https://docs.microsoft.com/en-us/sql/t-sql/statements/update-statistics-transact-sql?view=sql-server-2017" rel="noopener noreferrer nofollow" target="_blank">Update Statistics Task</a>, as well. This Task updates query optimization Statistics, which in turn can lead to increased query performance. Updating query Statistics, requires that the queries to be recompiled. This can have the effect of reducing performance, so frequent updating of Statistics should be avoided.</p>
<p>The management of Statistics can be handled by <a href="https://blog.pythian.com/sql-server-statistics-maintenance-and-best-practices/" rel="noopener noreferrer nofollow" target="_blank">automatic options</a> and may be sufficient, to maintain performance. These options are Auto Create and  Auto Update. Auto Create will automatically create missing Statistics and Auto Update will update Statistics when they’re deemed to be out of date. Both of these are set from the Options tab of a Databases Properties. The Database Properties are available by right-clicking on a Database.</p>
<div class="wp-caption aligncenter" id="attachment_38999" style="width: 707px"><img alt="" aria-describedby="caption-attachment-38999" height="339" src="/assets/images/Auto-Update-Stats.png" title="" width="697"/><p class="wp-caption-text" id="caption-attachment-38999"><noscript><img alt="" height="339" sizes="(max-width: 697px) 100vw, 697px" src="/assets/images/Auto-Update-Stats.png" title="" width="697"/></noscript> Auto-create and Auto-up Statistics</p></div>
<p>Once the Tasks have been identified and the order in which the Tasks are executed, have been defined. The next step is to identify the database(s) to run this Task(s) on.</p>
<p><div class="wp-caption aligncenter" id="attachment_15779" style="width: 563px"><img alt="Specify Database[s] for Index Task" aria-describedby="caption-attachment-15779" height="536" src="/assets/images/select-database.png" title="" width="553"/><p class="wp-caption-text" id="caption-attachment-15779"><noscript><img alt="Specify Database[s] for Index Task" height="536" sizes="(max-width: 553px) 100vw, 553px" src="/assets/images/select-database.png" title="" width="553"/></noscript> Specify Database[s] for Index Task</p></div>Alternatively, if you have several PDM databases, the option ‘All user databases (excluding master, model, msdb, tempdb) can be selected. This option has the additional benefit of including any future databases.</p>
<p> </p>
<p style="text-align: left;">If you would like to have a report generated for the outcome of this task, identify how you would like this report created.</p>
<div class="wp-caption aligncenter" id="attachment_15778" style="width: 499px"><img alt="Report Options" aria-describedby="caption-attachment-15778" height="444" src="/assets/images/report-options.png" title="" width="489"/><p class="wp-caption-text" id="caption-attachment-15778"><noscript><img alt="Report Options" height="444" sizes="(max-width: 489px) 100vw, 489px" src="/assets/images/report-options.png" title="" width="489"/></noscript> Report Options</p></div>
<p>Confirm that the task is configured correctly and click on <strong>Finish</strong> to start the task.</p>
<div class="wp-caption aligncenter" id="attachment_15777" style="width: 508px"><img alt="Maintenance Plan Review" aria-describedby="caption-attachment-15777" height="449" src="/assets/images/plan-review.png" title="" width="498"/><p class="wp-caption-text" id="caption-attachment-15777"><noscript><img alt="Maintenance Plan Review" height="449" sizes="(max-width: 498px) 100vw, 498px" src="/assets/images/plan-review.png" title="" width="498"/></noscript> Maintenance Plan Review</p></div>
<p>When the task is complete you can review the results and the report.</p>
<div class="wp-caption aligncenter" id="attachment_15775" style="width: 611px"><img alt="Maintenance Plan Complete" aria-describedby="caption-attachment-15775" height="497" src="/assets/images/plan-progress.png" title="" width="601"/><p class="wp-caption-text" id="caption-attachment-15775"><noscript><img alt="Maintenance Plan Complete" height="497" sizes="(max-width: 601px) 100vw, 601px" src="/assets/images/plan-progress.png" title="" width="601"/></noscript> Maintenance Plan Complete</p></div>
<p>The Maintenance plan will be saved for later use.</p>
<div class="wp-caption aligncenter" id="attachment_15784" style="width: 450px"><img alt="Saved Task" aria-describedby="caption-attachment-15784" height="497" src="/assets/images/saved-task.png" title="" width="440"/><p class="wp-caption-text" id="caption-attachment-15784"><noscript><img alt="Saved Task" height="497" sizes="(max-width: 440px) 100vw, 440px" src="/assets/images/saved-task.png" title="" width="440"/></noscript> Saved Task</p></div>
