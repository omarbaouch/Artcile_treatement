<p>SQL queries are the bread and butter of information gathering from SQL databases. In this blog, we will learn how to access a SQL database and run a SQL Query.</p>
<h3>Access the SOLIDWORKS PDM SQL Database</h3>
<p>The first step is to access SQL Server Management Studio (SSMS), the main application for configuring, managing, and administering SQL server components. This application will be running on your PDM database server.</p>
<div id="attachment_63908" style="width: 358px" class="wp-caption aligncenter"><img decoding="async" aria-describedby="caption-attachment-63908" class="wp-image-63908 size-full lazyload" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-1.png" alt="" width="348" height="546" title=""><p id="caption-attachment-63908" class="wp-caption-text"><noscript><img decoding="async" class="wp-image-63908 size-full lazyload" src="https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-1.png" alt="" width="348" height="546" title=""></noscript> SQL Server Management Studio</p></div>
<p>When opening SSMS you will be greeted by a server connection pop-up. <a href="https://www.javelin-tech.com/3d/technology/solidworks-pdm/" target="_blank" rel="noopener">PDM</a> typically uses the System Administrator (sa) account as its main connection point to SQL, but the SA account is not required to run database queries, a Windows account will also work. Either option can be chosen from the <strong>Authentication</strong> drop-down.</p>
<div id="attachment_63909" style="width: 963px" class="wp-caption aligncenter"><img decoding="async" aria-describedby="caption-attachment-63909" class="wp-image-63909 size-full lazyload" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-2.png" alt="" width="953" height="314" title=""><p id="caption-attachment-63909" class="wp-caption-text"><noscript><img decoding="async" class="wp-image-63909 size-full lazyload" src="https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-2.png" alt="" width="953" height="314" title="" srcset="https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-2.png 953w, https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-2-600x198.png 600w, https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-2-768x253.png 768w" sizes="(max-width: 953px) 100vw, 953px" /></noscript> Connecting To the SQL Database</p></div>
<h3>Running a SOLIDWORKS PDM SQL Query</h3>
<p>Once a connection has been established you will be presented with the Object Explorer, which will include each vault as a distinct database. Selecting New Query or right-clicking a vault and selecting New Query will open a new window:</p>
<div id="attachment_63911" style="width: 792px" class="wp-caption aligncenter"><img decoding="async" aria-describedby="caption-attachment-63911" class="wp-image-63911 size-full lazyload" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-3-1.png" alt="" width="782" height="376" title=""><p id="caption-attachment-63911" class="wp-caption-text"><noscript><img decoding="async" class="wp-image-63911 size-full lazyload" src="https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-3-1.png" alt="" width="782" height="376" title="" srcset="https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-3-1.png 782w, https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-3-1-600x288.png 600w, https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-3-1-768x369.png 768w" sizes="(max-width: 782px) 100vw, 782px" /></noscript> Starting a New Query</p></div>
<p>Paste your query here (double clicking on a .sql file will automatically open the query view), select the vault, and <strong>Execute</strong>.</p>
<div id="attachment_63917" style="width: 1012px" class="wp-caption aligncenter"><img decoding="async" aria-describedby="caption-attachment-63917" class="wp-image-63917 size-full lazyload" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-4.png" alt="" width="1002" height="352" title=""><p id="caption-attachment-63917" class="wp-caption-text"><noscript><img decoding="async" class="wp-image-63917 size-full lazyload" src="https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-4.png" alt="" width="1002" height="352" title="" srcset="https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-4.png 1002w, https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-4-600x211.png 600w, https://www.javelin-tech.com/blog/wp-content/uploads/2024/06/SQL-4-768x270.png 768w" sizes="(max-width: 1002px) 100vw, 1002px" /></noscript> Sample Query</p></div>
<p>The query in the above picture can be used as a sample, it will list all user information details such as email address, phone number, address, and presence note.</p>
<pre>--Query to show user details example--
select u.Username,
isnull (u.FullName , '') as [Full Name],
isnull (u.Email,'') as [Email],
isnull ((select value from settings where userid = u.UserID and varID =34), '') as [Phone],
isnull ((select value from settings where userid = u.UserID and varID =35), '') as [Cellphone],
isnull ((select value from settings where userid = u.UserID and VarID =36), '') as [Presence Note],
isnull ((select value from settings where userid = u.UserID and varID =37), '') as [Website 1],
isnull ((select value from settings where userid = u.UserID and varID =38), '') as [Website 2],
isnull ((select value from settings where userid = u.UserID and varID =39), '') as [Website 3],
isnull ((select value from settings where userid = u.UserID and varID =40), '') as [Website 4]
from Users u where u.UserID != 1 and u.Enabled = 1
and u.Username like N'admin'
order by u.Username
</pre>
<h3>Learn more about SOLIDWORKS PDM and SQL Query</h3>
<p>Take a <a href="https://www.javelin-tech.com/3d/people/solidworks-pdm-training/">SOLIDWORKS PDM training course</a> live online and learn more about data management from the experts at Javelin.</p>
