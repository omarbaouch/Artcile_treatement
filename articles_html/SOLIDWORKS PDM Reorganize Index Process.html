<p>SOLIDWORKS PDM Reorganize Index or Rebuild can increase performance on a <a href="https://www.javelin-tech.com/blog/2015/08/checking-for-index-fragmentation/">fragmented database</a>. If fragmentation is between 10 &#8211; 30% then Reorganize is recommended, when above 30% a Rebuild would be best. <strong>For fragmentation values lower than 10%, or for smaller databases, Reorganize and Rebuild may not increase performance</strong>. The SOLIDWORKS Knowledge Base article S-061702 offers a query to find average fragmentation and provides guidance on whether to use the Reorganize or Rebuild tasks.</p>
<h3>How to Reorganize a Single Database</h3>
<p>In the example below, we will look at how to create a one-time task to <strong>Reorganize</strong> a single database. I am specifying a one-time task as I wish to only use this task when fragmentation is between 10 &#8211; 30% as noted earlier.</p>
<p>In Microsoft SQL Server Management Studio (2014), under <strong>Management</strong>, right-click on <strong>Management Plans</strong> and select <strong>Maintenance Plan Wizard.</strong></p>
<div id="attachment_15780" style="width: 432px" class="wp-caption aligncenter"><img decoding="async" aria-describedby="caption-attachment-15780" class="wp-image-15780 size-full lazyload" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/start-task.png" alt="Start Maintenance Plan Wizard" width="422" height="499" title=""><p id="caption-attachment-15780" class="wp-caption-text"><noscript><img decoding="async" class="wp-image-15780 size-full lazyload" src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/start-task.png" alt="Start Maintenance Plan Wizard" width="422" height="499" title="" srcset="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/start-task.png 422w, https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/start-task-254x300.png 254w" sizes="(max-width: 422px) 100vw, 422px" /></noscript> Start Maintenance Plan Wizard</p></div>
<p>Identify the <strong>Plan Properties</strong>. Since I only want to run this task when there is a minimum amount of fragmentation, I will run this task on-demand, by selecting the<strong> Not Scheduled</strong> option</p>
<div id="attachment_15776" style="width: 511px" class="wp-caption aligncenter"><img decoding="async" aria-describedby="caption-attachment-15776" class="wp-image-15776 size-full lazyload" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/plan-properties.png" alt="Maintenance Plan Properties" width="501" height="452" title=""><p id="caption-attachment-15776" class="wp-caption-text"><noscript><img decoding="async" class="wp-image-15776 size-full lazyload" src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/plan-properties.png" alt="Maintenance Plan Properties" width="501" height="452" title="" srcset="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/plan-properties.png 501w, https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/plan-properties-300x271.png 300w" sizes="(max-width: 501px) 100vw, 501px" /></noscript> Maintenance Plan Properties</p></div>
<p>&nbsp;</p>
<p>Select the Maintenance Task(s) that will be executed by this Plan.</p>
<div id="attachment_38986" style="width: 511px" class="wp-caption aligncenter"><img decoding="async" aria-describedby="caption-attachment-38986" class="wp-image-38986 size-full lazyload" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/08/Maitenance-Plans-1.png" alt="" width="501" height="453" title=""><p id="caption-attachment-38986" class="wp-caption-text"><noscript><img decoding="async" class="wp-image-38986 size-full lazyload" src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/08/Maitenance-Plans-1.png" alt="" width="501" height="453" title=""></noscript> Maintenance Plan Tasks</p></div>
<p>Along with the Reorganize Task, I have also selected the <a href="https://docs.microsoft.com/en-us/sql/t-sql/statements/update-statistics-transact-sql?view=sql-server-2017" target="_blank" rel="noopener noreferrer nofollow">Update Statistics Task</a>, as well. This Task updates query optimization Statistics, which in turn can lead to increased query performance. Updating query Statistics, requires that the queries to be recompiled. This can have the effect of reducing performance, so frequent updating of Statistics should be avoided.</p>
<p>The management of Statistics can be handled by <a href="https://blog.pythian.com/sql-server-statistics-maintenance-and-best-practices/" target="_blank" rel="noopener noreferrer nofollow">automatic options</a> and may be sufficient, to maintain performance. These options are Auto Create and  Auto Update. Auto Create will automatically create missing Statistics and Auto Update will update Statistics when they&#8217;re deemed to be out of date. Both of these are set from the Options tab of a Databases Properties. The Database Properties are available by right-clicking on a Database.</p>
<div id="attachment_38999" style="width: 707px" class="wp-caption aligncenter"><img decoding="async" aria-describedby="caption-attachment-38999" class="wp-image-38999 size-full lazyload" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.javelin-tech.com/blog/wp-content/uploads/2018/11/Auto-Update-Stats.png" alt="" width="697" height="339" title=""><p id="caption-attachment-38999" class="wp-caption-text"><noscript><img decoding="async" class="wp-image-38999 size-full lazyload" src="https://www.javelin-tech.com/blog/wp-content/uploads/2018/11/Auto-Update-Stats.png" alt="" width="697" height="339" title="" srcset="https://www.javelin-tech.com/blog/wp-content/uploads/2018/11/Auto-Update-Stats.png 697w, https://www.javelin-tech.com/blog/wp-content/uploads/2018/11/Auto-Update-Stats-600x292.png 600w" sizes="(max-width: 697px) 100vw, 697px" /></noscript> Auto-create and Auto-up Statistics</p></div>
<p>Once the Tasks have been identified and the order in which the Tasks are executed, have been defined. The next step is to identify the database(s) to run this Task(s) on.</p>
<p><div id="attachment_15779" style="width: 563px" class="wp-caption aligncenter"><img decoding="async" aria-describedby="caption-attachment-15779" class="wp-image-15779 size-full lazyload" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/select-database.png" alt="Specify Database[s] for Index Task" width="553" height="536" title=""><p id="caption-attachment-15779" class="wp-caption-text"><noscript><img decoding="async" class="wp-image-15779 size-full lazyload" src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/select-database.png" alt="Specify Database[s] for Index Task" width="553" height="536" title="" srcset="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/select-database.png 553w, https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/select-database-300x291.png 300w" sizes="(max-width: 553px) 100vw, 553px" /></noscript> Specify Database[s] for Index Task</p></div>Alternatively, if you have several PDM databases, the option &#8216;All user databases (excluding master, model, msdb, tempdb) can be selected. This option has the additional benefit of including any future databases.</p>
<p>&nbsp;</p>
<p style="text-align: left;">If you would like to have a report generated for the outcome of this task, identify how you would like this report created.</p>
<div id="attachment_15778" style="width: 499px" class="wp-caption aligncenter"><img decoding="async" aria-describedby="caption-attachment-15778" class="wp-image-15778 size-full lazyload" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/report-options.png" alt="Report Options" width="489" height="444" title=""><p id="caption-attachment-15778" class="wp-caption-text"><noscript><img decoding="async" class="wp-image-15778 size-full lazyload" src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/report-options.png" alt="Report Options" width="489" height="444" title="" srcset="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/report-options.png 489w, https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/report-options-300x272.png 300w" sizes="(max-width: 489px) 100vw, 489px" /></noscript> Report Options</p></div>
<p>Confirm that the task is configured correctly and click on <strong>Finish</strong> to start the task.</p>
<div id="attachment_15777" style="width: 508px" class="wp-caption aligncenter"><img decoding="async" aria-describedby="caption-attachment-15777" class="wp-image-15777 size-full lazyload" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/plan-review.png" alt="Maintenance Plan Review" width="498" height="449" title=""><p id="caption-attachment-15777" class="wp-caption-text"><noscript><img decoding="async" class="wp-image-15777 size-full lazyload" src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/plan-review.png" alt="Maintenance Plan Review" width="498" height="449" title="" srcset="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/plan-review.png 498w, https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/plan-review-300x270.png 300w" sizes="(max-width: 498px) 100vw, 498px" /></noscript> Maintenance Plan Review</p></div>
<p>When the task is complete you can review the results and the report.</p>
<div id="attachment_15775" style="width: 611px" class="wp-caption aligncenter"><img decoding="async" aria-describedby="caption-attachment-15775" class="wp-image-15775 size-full lazyload" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/plan-progress.png" alt="Maintenance Plan Complete" width="601" height="497" title=""><p id="caption-attachment-15775" class="wp-caption-text"><noscript><img decoding="async" class="wp-image-15775 size-full lazyload" src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/plan-progress.png" alt="Maintenance Plan Complete" width="601" height="497" title="" srcset="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/plan-progress.png 601w, https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/plan-progress-300x248.png 300w" sizes="(max-width: 601px) 100vw, 601px" /></noscript> Maintenance Plan Complete</p></div>
<p>The Maintenance plan will be saved for later use.</p>
<div id="attachment_15784" style="width: 450px" class="wp-caption aligncenter"><img decoding="async" aria-describedby="caption-attachment-15784" class="wp-image-15784 size-full lazyload" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/saved-task.png" alt="Saved Task" width="440" height="497" title=""><p id="caption-attachment-15784" class="wp-caption-text"><noscript><img decoding="async" class="wp-image-15784 size-full lazyload" src="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/saved-task.png" alt="Saved Task" width="440" height="497" title="" srcset="https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/saved-task.png 440w, https://www.javelin-tech.com/blog/wp-content/uploads/2015/07/saved-task-266x300.png 266w" sizes="(max-width: 440px) 100vw, 440px" /></noscript> Saved Task</p></div>
