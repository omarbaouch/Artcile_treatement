<p>The default SOLIDWORKS Convert Task in PDM Professional (tasks are not available in SOLIDWORKS PDM Standard) allows you to export to many different file types.</p>
<p>Unfortunately, at this time, .smg files (for SOLIDWORKS Composer) are not one of the supported file types.</p>
<p>However, the SOLIDWORKS Convert Task is also HIGHLY customizable, so while we don’t have the option to output to .smg in the task interface, with a few script changes we can make our own task to do this.</p>
<h3>Customized Convert Task Steps</h3>
<p>Here are the steps to create a custom convert task to produce Composer .smg files</p>
<p><strong>Step 1</strong>:  Right-click on the Convert Task and select “Copy”</p>
<div class="wp-caption aligncenter" id="attachment_21526" style="width: 954px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2016/06/Copy-Task.png"><img alt="Copy SOLIDWORKS Convert Task" aria-describedby="caption-attachment-21526" height="550" src="/assets/images/Copy-Task.png" title="" width="944"/><p class="wp-caption-text" id="caption-attachment-21526"><noscript><img alt="Copy SOLIDWORKS Convert Task" height="550" sizes="(max-width: 944px) 100vw, 944px" src="/assets/images/Copy-Task.png" title="" width="944"/></noscript></p></a> Copy Task</div>
<p><strong>Step 2</strong>:  Double click the new copy of the task that is created to begin editing it.  Start by renaming the custom task.</p>
<div class="wp-caption aligncenter" id="attachment_21527" style="width: 954px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2016/06/Name.png"><img alt="Enter a Name" aria-describedby="caption-attachment-21527" height="550" src="/assets/images/Name.png" title="" width="944"/><p class="wp-caption-text" id="caption-attachment-21527"><noscript><img alt="Enter a Name" height="550" sizes="(max-width: 944px) 100vw, 944px" src="/assets/images/Name.png" title="" width="944"/></noscript></p></a> Enter a Name</div>
<p><strong>Step 3</strong>:  On the “Execution Method” screen, make sure that the task is set up to run only on systems that have the SOLIDWORKS Composer Player software installed.</p>
<div class="wp-caption aligncenter" id="attachment_21531" style="width: 956px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2016/06/Task-System.png"><img alt="Task System" aria-describedby="caption-attachment-21531" height="552" src="/assets/images/Task-System.png" title="" width="946"/><p class="wp-caption-text" id="caption-attachment-21531"><noscript><img alt="Task System" height="552" sizes="(max-width: 946px) 100vw, 946px" src="/assets/images/Task-System.png" title="" width="946"/></noscript></p></a> Task System</div>
<p><strong>Step 4</strong>:  On the “Menu Command” screen, adjust the task’s label in the Right Click menu.</p>
<div class="wp-caption aligncenter" id="attachment_21528" style="width: 954px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2016/06/Right-Click-Menu.png"><img alt="Right-click Menu Command" aria-describedby="caption-attachment-21528" height="550" src="/assets/images/Right-Click-Menu.png" title="" width="944"/><p class="wp-caption-text" id="caption-attachment-21528"><noscript><img alt="Right-click Menu Command" height="550" sizes="(max-width: 944px) 100vw, 944px" src="/assets/images/Right-Click-Menu.png" title="" width="944"/></noscript></p></a> Right-click Menu Command</div>
<p><strong>Step 5</strong>:  On the “Conversion Settings” screen, ANY output file format can be selected, we will specify the .smg file output directly in the task script next.</p>
<div class="wp-caption aligncenter" id="attachment_21529" style="width: 954px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2016/06/Convertion-Settings.png"><img alt="Conversion Settings" aria-describedby="caption-attachment-21529" height="550" src="/assets/images/Convertion-Settings.png" title="" width="944"/><p class="wp-caption-text" id="caption-attachment-21529"><noscript><img alt="Conversion Settings" height="550" sizes="(max-width: 944px) 100vw, 944px" src="/assets/images/Convertion-Settings.png" title="" width="944"/></noscript></p></a> Conversion Settings</div>
<p> </p>
<p><strong>Step 6</strong>:  On the “Output File Details” screen, click the “Advanced Scripting Options …” button.</p>
<div class="wp-caption aligncenter" id="attachment_21532" style="width: 956px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2016/06/Task-Details.png"><img alt="Task Details" aria-describedby="caption-attachment-21532" height="552" src="/assets/images/Task-Details.png" title="" width="946"/><p class="wp-caption-text" id="caption-attachment-21532"><noscript><img alt="Task Details" height="552" sizes="(max-width: 946px) 100vw, 946px" src="/assets/images/Task-Details.png" title="" width="946"/></noscript></p></a> Task Details</div>
<p><strong>Step 7</strong>:  Find and comment out the line <strong>ext = GetExtension(docType, “[FileFormat]”)</strong> by adding a ‘ at the beginning.  Next, immediately below add the line <strong>ext = GetExtension(docType, “(*.smg)”)</strong></p>
<div class="wp-caption aligncenter" id="attachment_21533" style="width: 537px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2016/06/Scripting-1.jpg"><img alt="Edit the script" aria-describedby="caption-attachment-21533" height="867" src="/assets/images/Scripting-1.jpg" title="" width="527"/><p class="wp-caption-text" id="caption-attachment-21533"><noscript><img alt="Edit the script" height="867" sizes="(max-width: 527px) 100vw, 527px" src="/assets/images/Scripting-1.jpg" title="" width="527"/></noscript></p></a> Edit the script</div>
<p><strong>Step 8</strong>:  Find the lines near the end of the script:</p>
<pre><strong>Else</strong>

 <strong> bIsSupportedExtension = False</strong></pre>
<p>Immediately above this add the lines:</p>
<pre><strong>ElseIf docFileName = "smg" Then</strong>

<strong>  bIsSupporterExtension = True</strong></pre>
<div class="wp-caption aligncenter" id="attachment_21534" style="width: 537px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2016/06/Scripting-2.png"><img alt="New lines added" aria-describedby="caption-attachment-21534" height="870" src="/assets/images/Scripting-2.png" title="" width="527"/><p class="wp-caption-text" id="caption-attachment-21534"><noscript><img alt="New lines added" height="870" sizes="(max-width: 527px) 100vw, 527px" src="/assets/images/Scripting-2.png" title="" width="527"/></noscript></p></a> New lines added</div>
<p><strong>Step 9</strong>:  Verify the location of the file <strong>composersolidworksplug-in.dll</strong>.  By default it will be in the folder <strong>C:\Program Files\SolidWorks Corp\Composer\Plugins\solidworks</strong>, however if SOLIDWORKS was installed to a different root directory, such as SOLIDWORKS 2016 instead of SolidWorks Corp, the path may be different.</p>
<p>If you are using 2014 or older, the plugin name is 3DViaSolidWorksPlug-in.dll</p>
<div class="wp-caption aligncenter" id="attachment_21535" style="width: 968px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2016/06/dll-location.png"><img alt="dll location" aria-describedby="caption-attachment-21535" height="830" src="/assets/images/dll-location.png" title="" width="958"/><p class="wp-caption-text" id="caption-attachment-21535"><noscript><img alt="dll location" height="830" sizes="(max-width: 958px) 100vw, 958px" src="/assets/images/dll-location.png" title="" width="958"/></noscript></p></a> dll location</div>
<p> </p>
<p><strong>Step 10</strong>:  Find the line:  <strong>Convert docFileName  </strong></p>
<p>Immediately above this add the line:</p>
<p><strong>AddInStatus = swApp.LoadAddIn(“C:\Program Files\SolidWorks Corp\Composer\Plugins\solidworks\composersolidworksplug-in.dll”)</strong></p>
<p>Change the path shown in the line above if the path to the .dll on the system that will run the task is different.  Ensure that ALL systems that will act as hosts for this task have the same path to the plugin.</p>
<div class="wp-caption aligncenter" id="attachment_21536" style="width: 1026px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2016/06/Scripting-3.png"><img alt="Add another line" aria-describedby="caption-attachment-21536" height="715" src="/assets/images/Scripting-3.png" title="" width="1016"/><p class="wp-caption-text" id="caption-attachment-21536"><noscript><img alt="Add another line" height="715" sizes="(max-width: 1016px) 100vw, 1016px" src="/assets/images/Scripting-3.png" title="" width="1016"/></noscript></p></a> Add another line</div>
<p>Once the task is set up, you can now either launch the task from a right-click menu, or you can trigger it automatically from a Workflow Transition.</p>
