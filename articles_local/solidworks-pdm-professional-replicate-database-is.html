<p>Starting with the 2017 release of <a href="https://www.javelin-tech.com/blog/solidworks-pdm-2017/" target="_blank">SOLIDWORKS PDM Professional</a>, administrators can now take advantage of the <a href="https://msdn.microsoft.com/en-us/library/ff878265.aspx" rel="nofollow noopener" target="_blank">“AlwaysOn Availability Groups” or AOAG in Microsoft SQL Enterprise edition</a>.  This will allow for replication of the vault database to multiple locations.</p>
<p>Previously, replication in PDM was available for Archives only.  This functionality allowed the actual files themselves to be replicated to additional Archive servers in different locations that the users could then connect to.</p>
<h3>Archive Replication Limitations</h3>
<p>As an example, if a company has a headquarters in Toronto, and design teams in Vancouver, Los Angeles, Munich and Guangzhou, a replicated Archive server should be set up in each location so that when users “Get” files or “Check In” files, the files are moving across their local network, instead of all that data needing to be sent from a continent away with each action.</p>
<p>However, until now, all of the locations still had to communicate with the Microsoft SQL Database server at the main office location for ANY action in the vault.  While these database transactions are using only small amounts of data, this would still result in delays compared to users who are at the same physical site as the Database server.</p>
<p>This becomes especially noticeable when the communication has to cross an ocean.  While latency between offices in Toronto and Vancouver, or Vancouver and Los Angeles might not be too bad, and barely cause a noticeable lag. Users in China or Germany would experience a significant performance issue when performing actions such as a Search or while waiting for the list of referenced files to generate when trying to get a large assembly.</p>
<h3>Replicating the Vault Database</h3>
<p>The SOLIDWORKS PDM Professional Replication functionality in the 2017 allows you to replicate not just the Vault Archives, but also the Vault Database.</p>
<blockquote><p>SOLIDWORKS PDM Professional Replicate Vault<strong> requires Microsoft SQL Enterprise edition</strong>.  This is not the version of Microsoft SQL that is included with a SOLIDWORKS PDM Professional license so the application would have to be purchased separately from Microsoft <em>(Microsoft SQL Standard edition is provided with a PDM Professional license)</em>.</p></blockquote>
<p>If you are experiencing significant latency, (for instance, anything over 50 milliseconds would cause a noticeable lag, over 200 milliseconds would become quite painful for users), then the additional cost of the SQL Enterprise edition licensing may quickly be returned by improved stability and productivity for users.</p>
<p><strong>Another example where this functionality may be very helpful is load balancing for very large and active vaults</strong>.  If there are a large number of users performing many searches, transitions and other operations in the vault, all of those actions are being handled by a single SQL server.  Splitting up the workload between multiple replicated SQL servers can have a significant effect on vault performance, especially if the bulk of the workload is coming from Searches.</p>
<p>However, please note, if you are experiencing performance delays from these types of operations, first it’s best to look into optimizing the SQL settings and hardware configuration to ensure that the existing SQL Server is able to run at peak efficiency (speak to your SOLIDWORKS PDM Value Added Reseller about recommendations for SQL settings and hardware configuration if you are running into some slowness in the vault).</p>
<h3>What is the setup process?</h3>
<p>Now in SOLIDWORKS PDM 2017, the Replication node can be expanded and you will see an entry for Archive and one for Database.</p>
<div class="wp-caption aligncenter" id="attachment_23449" style="width: 956px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2016/09/Admin.png"><img alt="SOLIDWORKS PDM Administration" aria-describedby="caption-attachment-23449" height="625" src="/assets/images/Admin.png" title="" width="946"/><p class="wp-caption-text" id="caption-attachment-23449"><noscript><img alt="SOLIDWORKS PDM Administration" height="625" sizes="(max-width: 946px) 100vw, 946px" src="/assets/images/Admin.png" title="" width="946"/></noscript></p></a> SOLIDWORKS PDM Administration</div>
<p>In the Database dialog you can add “Secondary SQL Servers” (this is different from replicated Archive servers which have no Primary/Secondary relationship, all Archive servers are equal).</p>
<div class="wp-caption aligncenter" id="attachment_23450" style="width: 956px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2016/09/Add-Server.png"><img alt="Add Server" aria-describedby="caption-attachment-23450" height="625" src="/assets/images/Add-Server.png" title="" width="946"/><p class="wp-caption-text" id="caption-attachment-23450"><noscript><img alt="Add Server" height="625" sizes="(max-width: 946px) 100vw, 946px" src="/assets/images/Add-Server.png" title="" width="946"/></noscript></p></a> Add Server</div>
<p>For replicated Database servers, the initial SQL Server is the “Primary” server.  This server is designated as a Read/Write database.  It handles all Write operations (such as Transitions, Check Ins, Check Outs, Moves, Renames etc).  It will periodically update the “Secondary” server(s).</p>
<p>The “Secondary” servers are designated as Read Only databases.  Only Read operations (such as Searches, Browsing through the vault or gathering file lists for Get actions) will be performed on these servers.</p>
<p>User’s must still be able to connect to both the “Primary” and “Secondary” archive server to take advantage of the functionality.  If they cannot connect to the “Secondary” server, then all actions will be performed on the “Primary” server.  If they cannot connect to the “Primary” server, then they cannot log in to the vault.</p>
<div class="wp-caption aligncenter" id="attachment_23451" style="width: 956px"><a href="https://www.javelin-tech.com/blog/wp-content/uploads/2016/09/Secondary-SQL-Server-Configuration.png"><img alt="SOLIDWORKS PDM Professional Replicate Vault Configuration" aria-describedby="caption-attachment-23451" height="625" src="/assets/images/Secondary-SQL-Server-Configuration.png" title="" width="946"/><p class="wp-caption-text" id="caption-attachment-23451"><noscript><img alt="SOLIDWORKS PDM Professional Replicate Vault Configuration" height="625" sizes="(max-width: 946px) 100vw, 946px" src="/assets/images/Secondary-SQL-Server-Configuration.png" title="" width="946"/></noscript></p></a> Secondary Server Configuration</div>
<p>In the Configuration Dialog for the Secondary Server you can select the server name, or enter it’s IP address.</p>
<p>In the “Max. Lag from Primary” box enter the maximum permissible time since the Primary server updated the Secondary server that you want to allow users to read information from the Secondary server.  This can be set from 1 minute up to 60 minutes.  When the actual time exceeds this setting then all read operation are directed to the primary server.  This is to ensure that the users are viewing up to date information.</p>
<p>Using the Add Member command you can specify which Users or Groups should be using this Secondary server for their read operations.</p>
